<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج جرد وتسليم معدات (Field Medicine-HMG) - مبسط</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
/* 1. SETUP & STYLING (MATCHING THE PROVIDED TEMPLATE) */
* { box-sizing: border-box; direction: rtl; }

body {
  background-color: #e2e8f0;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 0;
  padding: 20px;
  min-height: 100vh;
  font-family: 'Cairo', sans-serif;
}

/* --- DOCUMENT STYLES (A4) --- */
.a4-document {
  width: 100%; max-width: 800px; 
  background-color: #FFFFFF;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 30px;
  font-family: 'Cairo', sans-serif;
}

/* Typography */
.a4-document h1, .a4-document h3, .a4-document h4 { color: #B71C1C; font-weight: 700; margin: 0; text-align: right; width: 100%; }
.a4-document h1 { font-size: 28px; line-height: 1.2; }
.a4-document h3 { font-size: 15px; margin-top: 15px; border-bottom: 2px solid #D32F2F; padding-bottom: 5px; color: #D32F2F; }
.a4-document h4 { font-size: 14px; margin-top: 10px; margin-bottom: 5px; color: #B71C1C; }
.a4-document p, .a4-document td, .a4-document li { color: #334155; font-size: 11px; line-height: 1.5; }
.subtitle { font-size: 16px; font-weight: 400; color: #334155; margin-top: 5px; }

/* Header (Modified: Removed Logo Container) */
.header-section { display: flex; justify-content: flex-start; margin-bottom: 15px; align-items: center; } 

/* Tables */
table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
td, th { border: 1px solid #e2e8f0; padding: 6px; vertical-align: middle; }
th { background: #F8FAFC; color: #334155; font-weight: 600; font-size: 11px; text-align: center; }

/* Admin Table Specifics */
.admin-table th { width: 15%; background-color: #f9f9f9; }
.admin-table td { width: 35%; }

/* Inputs */
input, select, textarea.form-field { 
    width: 100%; border: 1px solid #e2e8f0; background: transparent; 
    font-family: 'Cairo', sans-serif; font-size: 11px; padding: 4px; border-radius: 4px;
}
input:focus, select:focus, textarea:focus { outline: 2px solid #D32F2F; border-color: transparent; }

.col-category { background-color: #fef2f2; color: #B71C1C; font-weight: 700; text-align: center; font-size: 12px; }

/* --- NOTES FIELD --- */
.general-notes {
    width: 100%;
    border: 1px solid #cbd5e1;
    border-radius: 4px;
    padding: 8px;
    min-height: 50px;
    font-family: 'Cairo', sans-serif;
    font-size: 12px;
    background-color: #f8fafc;
    margin-bottom: 15px;
}

/* --- DECLARATION --- */
.declaration-box {
    border: 2px solid #7f1d1d; background-color: #fff5f5;
    padding: 10px; border-radius: 6px; margin-bottom: 15px; text-align: center;
}
.declaration-text { font-size: 12px; color: #333; font-weight: 600; line-height: 1.6; }

/* --- SIGNATURE PAD STYLES --- */
.signature-container {
    position: relative; width: 100%; height: 90px;
    border: 1px dashed #cbd5e1; background-color: #f8fafc;
    border-radius: 4px; overflow: hidden; touch-action: none;
}
.signature-container canvas { width: 100%; height: 100%; display: block; }
.clear-sig-btn {
    position: absolute; top: 5px; left: 5px;
    background-color: rgba(255, 255, 255, 0.8);
    border: 1px solid #e2e8f0; font-size: 9px; padding: 2px 6px;
    border-radius: 4px; cursor: pointer; color: #ef4444; font-weight: bold; z-index: 3;
}
.sig-placeholder {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    color: #94a3b8; font-size: 10px; pointer-events: none; opacity: 0.7; z-index: 1;
}

/* Print Styles */
@media print {
    body { background: none; padding: 0; }
    .a4-document { box-shadow: none; padding: 0; width: 100%; max-width: none; }
    input, select, textarea { border: none !important; -webkit-appearance: none; }
    .signature-container { border: 1px solid #000; background: none; }
    .clear-sig-btn, .sig-placeholder { display: none; }
    .signature-container canvas { display: none !important; }
    .signature-container img { display: block !important; }
}
    </style>
</head>
<body>

<div class="a4-document" id="a4-form">
    
    <div class="header-section">
        <div>
            <h1>نموذج جرد وتسليم معدات (Field Medicine-HMG)</h1>
            <p class="subtitle">Equipment Inventory & Handover Form</p>
            <p class="subtitle" style="font-weight: 600;">قائمة تدقيق وجاهزية المعدات الطبية - الإجمالي: 47 وحدة</p>
        </div>
    </div>

    <h3>I. بيانات الاستلام والموقع (Receiving Information)</h3>
    <table class="admin-table">
        <tbody>
            <tr>
                <th>التاريخ (ميلادي)<br><span style="font-weight:normal; font-size:10px;">Date</span></th>
                <td><input type="date" id="admin-date"></td>
                <th>الوقت<br><span style="font-weight:normal; font-size:10px;">Time</span></th>
                <td><input type="time" id="admin-time"></td>
            </tr>
            <tr>
                <th>الموقع (Location)<br><span style="font-weight:normal; font-size:10px;">Site/Unit</span></th>
                <td><input type="text" placeholder="مثال: وحدة الإمداد/وحدة طب الميدان" id="admin-location"></td>
                <th>اسم المسؤول<br><span style="font-weight:normal; font-size:10px;">Supervisor Name</span></th>
                <td><input type="text" id="admin-supervisor"></td>
            </tr>
            <tr>
                <th>اسم المستلم<br><span style="font-weight:normal; font-size:10px;">Receiver Name</span></th>
                <td><input type="text" id="admin-receiver"></td>
                <th>الرقم الوظيفي<br><span style="font-weight:normal; font-size:10px;">Employee ID</span></th>
                <td><input type="text" id="admin-id"></td>
            </tr>
        </tbody>
    </table>

    <h3>II. قائمة الجرد والتدقيق (Inventory Checklist)</h3>
    <table>
        <thead>
            <tr>
                <th style="width:5%">#</th>
                <th style="width:65%">اسم المعدة (EQUIPMENTS)</th>
                <th style="width:15%">الكمية المطلوبة (REQ QTY)</th>
                <th style="width:15%">الكمية المتاحة (AVAIL QTY)</th>
            </tr>
        </thead>
        <tbody>
            <tr><td colspan="4" class="col-category">قائمة المعدات الطبية لـ Field Medicine-HMG</td></tr>
            
            <tr><td>1</td><td>STRETCHERER-OBSERVATION</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>2</td><td>STRETCHER - FESSIS BED</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>3</td><td>LIGHT-WET CYH ALLEN</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>4</td><td>REFRIGERATOR MEDICATION/VACCINATION</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>5</td><td>ELECTROCARDIOGRAPH (ECG), INTERPRETIVE-ER</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>6</td><td>CART, PROCEDURE, RESUSCITATION</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>7</td><td>CART-BLUE</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>8</td><td>PUMP, VOLUMETRIC, SYRINGE</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>9</td><td>PUMP, VOLUMETRIC, INFUSION</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>10</td><td>SUCTION DEVILIBS, PORTABLE</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>11</td><td>DEFIBRILLATOR, ALL AGES ACCESSORIES)-ER-20</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>12</td><td>MONITOR, PHYSIOLOGIC VITAL SIGNS-WHIT</td><td>2</td><td><input type="number" min="0" value="2" class="form-field"></td></tr>
            <tr><td>13</td><td>VENTILATOR, PORTABLE - REW</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>14</td><td>MONITOR, PHYSIOLOGIC BEDSIDE(ER/RECOVERY)5000</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>15</td><td>X-RAY SYSTEM, PORTABLE FULL ECSOSARIS</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>16</td><td>OPTHA/OTO ER</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>17</td><td>OPTHA/OTO DEGITAL</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>18</td><td>IV STAND</td><td>2</td><td><input type="number" min="0" value="2" class="form-field"></td></tr>
            <tr><td>19</td><td>O2 CYLNDR</td><td>20</td><td><input type="number" min="0" value="20" class="form-field"></td></tr>
            <tr><td>20</td><td>I-STATE</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>21</td><td>TROP I</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>22</td><td>ULTRASOUND</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>23</td><td>C-MAC</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>
            <tr><td>24</td><td>NAERCOTIC-BOX</td><td>1</td><td><input type="number" min="0" value="1" class="form-field"></td></tr>

            <tr>
                <td colspan="2" style="text-align:center; font-weight:bold; background-color: #fef2f2;">المجموع الكلي للوحدات</td>
                <td style="font-weight:bold; background-color: #fef2f2;">47</td>
                <td style="font-weight:bold; background-color: #fef2f2; text-align:center;">(أدخل إجمالي الكمية المتاحة هنا)</td>
            </tr>
        </tbody>
    </table>

    <h3>III. الملاحظات (Notes)</h3>
    
    <div style="margin-bottom: 10px;">
        <label style="font-weight:bold; font-size:12px; color:#334155;">ملاحظات عامة (General Notes):</label>
        <textarea class="general-notes" placeholder="أكتب أي ملاحظات إضافية حول حالة المعدات أو النقص هنا..."></textarea>
    </div>

    <h3>IV. الإقرار (Declaration)</h3>

    <div class="declaration-box">
        <div class="declaration-text">
            أقرّ أنا المذكور أعلاه بأنني قمت بجرد واستلام المعدات المذكورة بحالة مطابقة لما هو موضح في هذا النموذج، وأتحمّل كامل المسؤولية عن أي إهمال أو سوء استخدام أو فقدان لأي من هذه المعدات خلال فترة استلامي لها.
        </div>
    </div>

    <h3>V. التواقيع</h3>
    <table class="signature-table">
        <tr>
            <td style="width:50%; vertical-align:top;">
                <b>اسم المستلم (Receiver Name):</b>
                <textarea id="receiver-notes" class="form-field" style="height:40px; margin-bottom:5px;"></textarea>
                <div style="font-weight:bold; margin-bottom:2px;">توقيع المستلم (Receiver Sig):</div>
                <div class="signature-container" id="sig-receiver-container">
                    <span class="sig-placeholder">وقع هنا</span>
                    <canvas id="sig-receiver"></canvas>
                    <img id="sig-receiver-img" class="preview-img" style="object-fit:contain; z-index: 0;">
                    <button class="clear-sig-btn" onclick="clearCanvas('sig-receiver')">مسح</button>
                </div>
            </td>
            <td style="width:50%; vertical-align:top;">
                <b>اسم المُسلّم (Endorser Name):</b>
                <textarea id="endorser-notes" class="form-field" style="height:40px; margin-bottom:5px;"></textarea>
                <div style="font-weight:bold; margin-bottom:2px;">توقيع المُسلّم (Endorser Sig):</div>
                <div class="signature-container" id="sig-endorser-container">
                    <span class="sig-placeholder">وقع هنا</span>
                    <canvas id="sig-endorser"></canvas>
                    <img id="sig-endorser-img" class="preview-img" style="object-fit:contain; z-index: 0;">
                    <button class="clear-sig-btn" onclick="clearCanvas('sig-endorser')">مسح</button>
                </div>
            </td>
        </tr>
    </table>
</div>

<script>
    // Initialize Date and Time
    document.getElementById('admin-date').valueAsDate = new Date();
    const now = new Date();
    document.getElementById('admin-time').value = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');

    // Signature Pad and Printing Fix Logic (Retained for interactive signatures)
    function saveSignatureAsImage(canvasId) {
        const canvas = document.getElementById(canvasId);
        const imgId = canvasId + '-img';
        const img = document.getElementById(imgId);
        
        const ctx = canvas.getContext('2d');
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        let isBlank = true;
        for (let i = 0; i < imageData.data.length; i += 4) {
            if (imageData.data[i + 3] !== 0) { 
                isBlank = false;
                break;
            }
        }

        if (!isBlank) {
            img.src = canvas.toDataURL('image/png');
            img.style.display = 'block'; 
            canvas.style.display = 'block'; 
        } else {
            img.src = '';
            img.style.display = 'none';
        }
    }

    function initSignaturePad(canvasId) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');
        const container = canvas.parentElement;
        let isDrawing = false;

        function resizeCanvas() {
            const rect = container.getBoundingClientRect();
            const originalData = canvas.toDataURL(); 
            canvas.width = rect.width;
            canvas.height = rect.height;
            ctx.lineWidth = 2; ctx.lineCap = 'round'; ctx.strokeStyle = '#000';
            
            if (originalData) {
                const img = new Image();
                img.onload = function() {
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    saveSignatureAsImage(canvasId); 
                };
                img.src = originalData;
            }
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        function startDrawing(e) {
            isDrawing = true; draw(e);
            container.querySelector('.sig-placeholder').style.display = 'none';
            canvas.style.display = 'block';
        }
        
        function stopDrawing() { 
            if (isDrawing) {
                saveSignatureAsImage(canvasId); 
            }
            isDrawing = false; 
            ctx.beginPath(); 
        }
        
        function draw(e) {
            if (!isDrawing) return; e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            let clientX = e.touches ? e.touches[0].clientX : e.clientX;
            let clientY = e.touches ? e.touches[0].clientY : e.clientY;
            ctx.lineTo(clientX - rect.left, clientY - rect.top);
            ctx.stroke(); 
            ctx.beginPath();
            ctx.moveTo(clientX - rect.left, clientY - rect.top);
        }

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('touchstart', startDrawing, {passive: false});
        canvas.addEventListener('touchend', stopDrawing);
        canvas.addEventListener('touchcancel', stopDrawing);
        canvas.addEventListener('touchmove', draw, {passive: false});
    }

    function clearCanvas(canvasId) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        canvas.parentElement.querySelector('.sig-placeholder').style.display = 'block';

        const imgId = canvasId + '-img';
        const img = document.getElementById(imgId);
        if (img) {
            img.src = '';
            img.style.display = 'none';
        }
    }

    window.onload = function() {
        initSignaturePad('sig-receiver');
        initSignaturePad('sig-endorser');
    };
</script>

</body>
</html>
